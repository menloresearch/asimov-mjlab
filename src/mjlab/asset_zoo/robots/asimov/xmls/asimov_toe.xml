<mujoco model="asimov_toe">
  <default>
    <default class="robot">
      <default class="motor">
        <joint />
        <motor />
      </default>
      <default class="visual">
        <geom material="visualgeom" contype="0" conaffinity="0" group="2" />
      </default>
      <default class="collision">
        <geom material="collision_material" condim="3" contype="0" conaffinity="1" priority="1" group="1" solref="0.005 1" solimp="0.99 0.999 1e-05" friction="1 0.01 0.01" />
        <default class="foot_capsule">
          <geom type="capsule" size="0.01" />
        </default>
      </default>
    </default>
  </default>

  <compiler angle="radian" />

  <asset>
    <material name="visualgeom" rgba="0.75294 0.75294 0.75294 1" />
    <material name="default_material" rgba="0.7 0.7 0.7 1" />
    <material name="collision_material" rgba="1.0 0.28 0.1 0.9" />
    <mesh name="pelvis_link.STL" file="pelvis_link.STL"/>
    <mesh name="left_hip_pitch_link.STL" file="left_hip_pitch_link.STL"/>
    <mesh name="left_hip_roll_link.STL" file="left_hip_roll_link.STL"/>
    <mesh name="left_hip_yaw_link.STL" file="left_hip_yaw_link.STL"/>
    <mesh name="left_knee_link.STL" file="left_knee_link.STL"/>
    <mesh name="left_ankle_pitch_link.STL" file="left_ankle_pitch_link.STL"/>
    <mesh name="left_ankle_roll_link.STL" file="left_ankle_roll_link.STL"/>
    <mesh name="left_toe_link.STL" file="left_toe_link.STL"/>
    <mesh name="right_hip_pitch_link.STL" file="right_hip_pitch_link.STL"/>
    <mesh name="right_hip_roll_link.STL" file="right_hip_roll_link.STL"/>
    <mesh name="right_hip_yaw_link.STL" file="right_hip_yaw_link.STL"/>
    <mesh name="right_knee_link.STL" file="right_knee_link.STL"/>
    <mesh name="right_ankle_pitch_link.STL" file="right_ankle_pitch_link.STL"/>
    <mesh name="right_ankle_roll_link.STL" file="right_ankle_roll_link.STL"/>
    <mesh name="right_toe_link.STL" file="right_toe_link.STL"/>
  </asset>

  <worldbody>
    <body name="pelvis_link" pos="0.00000000 0.00000000 0.71572740" quat="1 0 0 0" childclass="robot">
      <freejoint name="floating_base" />
      <inertial pos="-0.00071228 -3.4719E-07 -0.073826" quat="1.0 0.0 0.0 0.0" mass="3.3125" diaginertia="0.0033117 0.0028238 0.003564" />
      <site name="imu" pos="0.0 0.0 0.0" size="0.01" rgba="1 0 0 1" type="sphere" />

      <geom name="pelvis_link_collision" pos="0 0 0" quat="1.0 0.0 0.0 0.0" type="mesh" mesh="pelvis_link.STL" class="collision" />
      <geom name="pelvis_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="pelvis_link.STL" class="visual" />
      <body name="left_hip_pitch_link" pos="0 0.056569 -0.10543" quat="1.0 0.0 0.0 0.0">
        <joint name="left_hip_pitch_joint" type="hinge" ref="0.0" class="motor" range="-2.094395 1" axis="0 0.70711 -0.70711" />
        <site name="left_hip_pitch_joint_site" pos="0 0 0" quat="1 0 0 0" />
        <inertial pos="0.00329 0.045581 -0.045581" quat="1.0 0.0 0.0 0.0" mass="0.92565" diaginertia="0.00053984 0.00066418 0.00066419" />
        <geom name="left_hip_pitch_link_collision" pos="0 0 0" quat="1.0 0.0 0.0 0.0" type="mesh" mesh="left_hip_pitch_link.STL" class="collision" />
        <geom name="left_hip_pitch_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="left_hip_pitch_link.STL" class="visual" />
        <body name="left_hip_roll_link" pos="0 0.051265 -0.051265" quat="1.0 0.0 0.0 0.0">
          <joint name="left_hip_roll_joint" type="hinge" ref="0.0" class="motor" range="-0.785398 0.785398" axis="-1 0 0" />
          <site name="left_hip_roll_joint_site" pos="0 0 0" quat="1 0 0 0" />
          <inertial pos="0.01525 -0.00017964 -0.061059" quat="1.0 0.0 0.0 0.0" mass="0.83528" diaginertia="0.00054401 0.00063585 0.00038113" />
          <geom name="left_hip_roll_link_collision" pos="0 0 0" quat="1.0 0.0 0.0 0.0" type="mesh" mesh="left_hip_roll_link.STL" class="collision" />
          <geom name="left_hip_roll_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="left_hip_roll_link.STL" class="visual" />
          <body name="left_hip_yaw_link" pos="0 0 -0.09275" quat="1.0 0.0 0.0 0.0">
            <joint name="left_hip_yaw_joint" type="hinge" ref="0.0" class="motor" range="-0.785398 0.785398" axis="0 0 -1" />
            <site name="left_hip_yaw_joint_site" pos="0 0 0" quat="1 0 0 0" />
            <inertial pos="7.0761E-05 0.00031363 -0.11496" quat="1.0 0.0 0.0 0.0" mass="1.2782" diaginertia="0.0024302 0.0025065 0.0007566" />
            <geom name="left_hip_yaw_link_collision" pos="0 0 0" quat="1.0 0.0 0.0 0.0" type="mesh" mesh="left_hip_yaw_link.STL" class="collision" />
            <geom name="left_hip_yaw_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="left_hip_yaw_link.STL" class="visual" />
            <body name="left_knee_link" pos="0 0 -0.15489" quat="1.0 0.0 0.0 0.0">
              <joint name="left_knee_joint" type="hinge" ref="0.0" class="motor" range="0 1.5" axis="0 1 0" />
              <site name="left_knee_joint_site" pos="0 0 0" quat="1 0 0 0" />
              <inertial pos="-0.0025212 0.00051084 -0.10659" quat="1.0 0.0 0.0 0.0" mass="2.2481" diaginertia="0.0093797 0.0095623 0.0023403" />
              <geom name="left_knee_link_collision" pos="0 0 0" quat="1.0 0.0 0.0 0.0" type="mesh" mesh="left_knee_link.STL" class="collision" />
              <geom name="left_knee_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="left_knee_link.STL" class="visual" />
              <body name="left_ankle_pitch_link" pos="0 0 -0.29466" quat="1.0 0.0 0.0 0.0">
                <joint name="left_ankle_pitch_joint" type="hinge" ref="0.0" class="motor" range="-0.349066 0.5" axis="0 1 0" />
                <site name="left_ankle_pitch_joint_site" pos="0 0 0" quat="1 0 0 0" />
                <inertial pos="-0.0011784 -2.4418E-08 -0.0061736" quat="1.0 0.0 0.0 0.0" mass="0.27369" diaginertia="6.4443e-05 8.1172e-05 4.7493e-05" />
                <geom name="left_ankle_pitch_link_collision" pos="0 0 0" quat="1.0 0.0 0.0 0.0" type="mesh" mesh="left_ankle_pitch_link.STL" class="collision" />
                <geom name="left_ankle_pitch_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="left_ankle_pitch_link.STL" class="visual" />
                <body name="left_ankle_roll_link" pos="-0.0015 0 -0.01" quat="1.0 0.0 0.0 0.0">
                  <joint name="left_ankle_roll_joint" type="hinge" ref="0.0" class="motor" range="-0.349066 0.349066" axis="-1 0 0" />
                  <site name="left_ankle_roll_joint_site" pos="0 0 0" quat="1 0 0 0" />
                  <inertial pos="0.081381 -0.00033806 -0.015509" quat="1.0 0.0 0.0 0.0" mass="0.61291" diaginertia="0.00031968 0.00045036 0.00070504" />
                  <geom name="left_ankle_roll_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="left_ankle_roll_link.STL" class="visual" />
                  <!-- Foot collision capsules - distributed contact surface -->
                  <geom name="left_foot1_collision" class="foot_capsule" fromto="0.08 -0.02 -0.02 0.04 -0.02 -0.02"/>
                  <geom name="left_foot2_collision" class="foot_capsule" fromto="0.0 -0.015 -0.02 0.10 -0.015 -0.02"/>
                  <geom name="left_foot3_collision" class="foot_capsule" fromto="-0.01 -0.008 -0.02 0.11 -0.008 -0.02"/>
                  <geom name="left_foot4_collision" class="foot_capsule" fromto="-0.015 0 -0.02 0.115 0 -0.02"/>
                  <geom name="left_foot5_collision" class="foot_capsule" fromto="-0.01 0.008 -0.02 0.11 0.008 -0.02"/>
                  <geom name="left_foot6_collision" class="foot_capsule" fromto="0.0 0.015 -0.02 0.10 0.015 -0.02"/>
                  <geom name="left_foot7_collision" class="foot_capsule" fromto="0.08 0.02 -0.02 0.04 0.02 -0.02"/>
                  <body name="left_toe_link" pos="0.10253 -0.0043664 -0.0067324" quat="1.0 0.0 0.0 0.0">
                    <joint name="left_toe_joint" type="hinge" ref="0.0" class="motor" range="-0.6 0.0" axis="0.010532 0.99994 0" />
                    <site name="left_toe_joint_site" pos="0 0 0" quat="1 0 0 0" />
                    <inertial pos="0.0320167773761624 0.000718248511968056 -0.0141312773022902" quat="1.0 0.0 0.0 0.0" mass="0.112221237946844" diaginertia="5.5351925218088e-05 3.65130809524718e-05 8.54029969529202e-05" />
                    <geom name="left_toe_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="left_toe_link.STL" class="visual" />
                    <!-- Toe collision capsules -->
                    <geom name="left_toe1_collision" class="foot_capsule" fromto="0.0 -0.008 -0.015 0.06 -0.008 -0.015"/>
                    <geom name="left_toe2_collision" class="foot_capsule" fromto="0.0 0 -0.015 0.06 0 -0.015"/>
                    <geom name="left_toe3_collision" class="foot_capsule" fromto="0.0 0.008 -0.015 0.06 0.008 -0.015"/>
                  </body>
                </body>
              </body>
            </body>
          </body>
        </body>
      </body>
      <body name="right_hip_pitch_link" pos="0 -0.056569 -0.10543" quat="1.0 0.0 0.0 0.0">
        <joint name="right_hip_pitch_joint" type="hinge" ref="0.0" class="motor" range="-1 2.094395" axis="0 -0.70711 -0.70711" />
        <site name="right_hip_pitch_joint_site" pos="0 0 0" quat="1 0 0 0" />
        <inertial pos="0.0032901 -0.045581 -0.045581" quat="1.0 0.0 0.0 0.0" mass="0.92565" diaginertia="0.00053984 0.00066418 0.00066418" />
        <geom name="right_hip_pitch_link_collision" pos="0 0 0" quat="1.0 0.0 0.0 0.0" type="mesh" mesh="right_hip_pitch_link.STL" class="collision" />
        <geom name="right_hip_pitch_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="right_hip_pitch_link.STL" class="visual" />
        <body name="right_hip_roll_link" pos="0 -0.051265 -0.051265" quat="1.0 0.0 0.0 0.0">
          <joint name="right_hip_roll_joint" type="hinge" ref="0.0" class="motor" range="-0.785398 0.785398" axis="-1 0 0" />
          <site name="right_hip_roll_joint_site" pos="0 0 0" quat="1 0 0 0" />
          <inertial pos="0.01525 0.0001796 -0.061059" quat="1.0 0.0 0.0 0.0" mass="0.83528" diaginertia="0.00054401 0.00063584 0.00038113" />
          <geom name="right_hip_roll_link_collision" pos="0 0 0" quat="1.0 0.0 0.0 0.0" type="mesh" mesh="right_hip_roll_link.STL" class="collision" />
          <geom name="right_hip_roll_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="right_hip_roll_link.STL" class="visual" />
          <body name="right_hip_yaw_link" pos="0 0 -0.09275" quat="1.0 0.0 0.0 0.0">
            <joint name="right_hip_yaw_joint" type="hinge" ref="0.0" class="motor" range="-0.785398 0.785398" axis="0 0 -1" />
            <site name="right_hip_yaw_joint_site" pos="0 0 0" quat="1 0 0 0" />
            <inertial pos="7.1067E-05 -0.00031339 -0.11496" quat="1.0 0.0 0.0 0.0" mass="1.2782" diaginertia="0.0024302 0.0025065 0.0007566" />
            <geom name="right_hip_yaw_link_collision" pos="0 0 0" quat="1.0 0.0 0.0 0.0" type="mesh" mesh="right_hip_yaw_link.STL" class="collision" />
            <geom name="right_hip_yaw_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="right_hip_yaw_link.STL" class="visual" />
            <body name="right_knee_link" pos="0 0 -0.15489" quat="1.0 0.0 0.0 0.0">
              <joint name="right_knee_joint" type="hinge" ref="0.0" class="motor" range="-1.5 0" axis="0 -1 0" />
              <site name="right_knee_joint_site" pos="0 0 0" quat="1 0 0 0" />
              <inertial pos="-0.0025213 -0.00051098 -0.10659" quat="1.0 0.0 0.0 0.0" mass="2.2481" diaginertia="0.0093796 0.0095623 0.0023403" />
              <geom name="right_knee_link_collision" pos="0 0 0" quat="1.0 0.0 0.0 0.0" type="mesh" mesh="right_knee_link.STL" class="collision" />
              <geom name="right_knee_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="right_knee_link.STL" class="visual" />
              <body name="right_ankle_pitch_link" pos="0 0 -0.29466" quat="1.0 0.0 0.0 0.0">
                <joint name="right_ankle_pitch_joint" type="hinge" ref="0.0" class="motor" range="-0.5 0.349066" axis="0 -1 0" />
                <site name="right_ankle_pitch_joint_site" pos="0 0 0" quat="1 0 0 0" />
                <inertial pos="-0.0011784 5.9726E-08 -0.0061735" quat="1.0 0.0 0.0 0.0" mass="0.27369" diaginertia="6.4442e-05 8.1171e-05 4.7493e-05" />
                <geom name="right_ankle_pitch_link_collision" pos="0 0 0" quat="1.0 0.0 0.0 0.0" type="mesh" mesh="right_ankle_pitch_link.STL" class="collision" />
                <geom name="right_ankle_pitch_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="right_ankle_pitch_link.STL" class="visual" />
                <body name="right_ankle_roll_link" pos="-0.0015 0 -0.01" quat="1.0 0.0 0.0 0.0">
                  <joint name="right_ankle_roll_joint" type="hinge" ref="0.0" class="motor" range="-0.349066 0.349066" axis="-1 0 0" />
                  <site name="right_ankle_roll_joint_site" pos="0 0 0" quat="1 0 0 0" />
                  <inertial pos="0.081347 0.00027474 -0.015509" quat="1.0 0.0 0.0 0.0" mass="0.61291" diaginertia="0.0003197 0.00045029 0.00070498" />
                  <geom name="right_ankle_roll_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="right_ankle_roll_link.STL" class="visual" />
                  <!-- Foot collision capsules - distributed contact surface -->
                  <geom name="right_foot1_collision" class="foot_capsule" fromto="0.08 -0.02 -0.02 0.04 -0.02 -0.02"/>
                  <geom name="right_foot2_collision" class="foot_capsule" fromto="0.0 -0.015 -0.02 0.10 -0.015 -0.02"/>
                  <geom name="right_foot3_collision" class="foot_capsule" fromto="-0.01 -0.008 -0.02 0.11 -0.008 -0.02"/>
                  <geom name="right_foot4_collision" class="foot_capsule" fromto="-0.015 0 -0.02 0.115 0 -0.02"/>
                  <geom name="right_foot5_collision" class="foot_capsule" fromto="-0.01 0.008 -0.02 0.11 0.008 -0.02"/>
                  <geom name="right_foot6_collision" class="foot_capsule" fromto="0.0 0.015 -0.02 0.10 0.015 -0.02"/>
                  <geom name="right_foot7_collision" class="foot_capsule" fromto="0.08 0.02 -0.02 0.04 0.02 -0.02"/>
                  <body name="right_toe_link" pos="0.10247 0.0042796 -0.0067324" quat="1.0 0.0 0.0 0.0">
                    <joint name="right_toe_joint" type="hinge" ref="0.0" class="motor" range="0 0.6" axis="0.0074685 -0.99997 0" />
                    <site name="right_toe_joint_site" pos="0 0 0" quat="1 0 0 0" />
                    <inertial pos="0.0320141754360937 -0.000816708013105544 -0.0141309094649689" quat="1.0 0.0 0.0 0.0" mass="0.112221754054884" diaginertia="5.5358948695321e-05 3.65052769951383e-05 8.54017357052965e-05" />
                    <geom name="right_toe_link_visual" pos="0 0 0" quat="1.0 0.0 0.0 0.0" material="visualgeom" type="mesh" mesh="right_toe_link.STL" class="visual" />
                    <!-- Toe collision capsules -->
                    <geom name="right_toe1_collision" class="foot_capsule" fromto="0.0 -0.008 -0.015 0.06 -0.008 -0.015"/>
                    <geom name="right_toe2_collision" class="foot_capsule" fromto="0.0 0 -0.015 0.06 0 -0.015"/>
                    <geom name="right_toe3_collision" class="foot_capsule" fromto="0.0 0.008 -0.015 0.06 0.008 -0.015"/>
                  </body>
                </body>
              </body>
            </body>
          </body>
        </body>
      </body>
      <site name="world_site" pos="0 0 0" quat="1 0 0 0" />
      <camera name="front_camera" mode="track" fovy="90.0" quat="4.329780281177467e-17 4.329780281177466e-17 0.7071067811865475 0.7071067811865476" pos="0.0 2.0 0.5" />
      <camera name="side_camera" mode="track" fovy="90.0" quat="-0.5 -0.4999999999999999 0.5 0.5000000000000001" pos="-2.0 0.0 0.5" />
    </body>
  </worldbody>

  <!-- Fixed tendons implementing ankle A/B linearized mapping -->
  <tendon>
    <!-- Left ankle: A = -L*theta - d*phi, B = -L*theta + d*phi -->
    <fixed name="left_ankle_A">
      <joint joint="left_ankle_pitch_joint" coef="-0.09"/>
      <joint joint="left_ankle_roll_joint" coef="-0.02"/>
    </fixed>
    <fixed name="left_ankle_B">
      <joint joint="left_ankle_pitch_joint" coef="-0.09"/>
      <joint joint="left_ankle_roll_joint" coef="0.02"/>
    </fixed>

    <!-- Right ankle (note pitch axis flips): A = +L*theta - d*phi, B = +L*theta + d*phi -->
    <fixed name="right_ankle_A">
      <joint joint="right_ankle_pitch_joint" coef="0.09"/>
      <joint joint="right_ankle_roll_joint" coef="-0.02"/>
    </fixed>
    <fixed name="right_ankle_B">
      <joint joint="right_ankle_pitch_joint" coef="0.09"/>
      <joint joint="right_ankle_roll_joint" coef="0.02"/>
    </fixed>
  </tendon>

  <!-- Tendon position actuators for A/B control (length targets in meters) -->
  <!-- Forcerange set to 36 Nm based on encos current limits -->
  <actuator>
    <position name="left_ankle_A"  tendon="left_ankle_A"  kp="300" ctrllimited="true" ctrlrange="-0.08 0.08" forcerange="-72 72"/>
    <position name="left_ankle_B"  tendon="left_ankle_B"  kp="300" ctrllimited="true" ctrlrange="-0.08 0.08" forcerange="-72 72"/>
    <position name="right_ankle_A" tendon="right_ankle_A" kp="300" ctrllimited="true" ctrlrange="-0.08 0.08" forcerange="-72 72"/>
    <position name="right_ankle_B" tendon="right_ankle_B" kp="300" ctrllimited="true" ctrlrange="-0.08 0.08" forcerange="-72 72"/>
  </actuator>


  <contact>
    <exclude body1="pelvis_link" body2="left_hip_pitch_link" />
    <exclude body1="left_hip_pitch_link" body2="left_hip_roll_link" />
    <exclude body1="left_hip_roll_link" body2="left_hip_yaw_link" />
    <exclude body1="left_hip_yaw_link" body2="left_knee_link" />
    <exclude body1="left_knee_link" body2="left_ankle_pitch_link" />
    <exclude body1="left_ankle_pitch_link" body2="left_ankle_roll_link" />
    <exclude body1="left_ankle_roll_link" body2="left_toe_link" />
    <exclude body1="pelvis_link" body2="right_hip_pitch_link" />
    <exclude body1="right_hip_pitch_link" body2="right_hip_roll_link" />
    <exclude body1="right_hip_roll_link" body2="right_hip_yaw_link" />
    <exclude body1="right_hip_yaw_link" body2="right_knee_link" />
    <exclude body1="right_knee_link" body2="right_ankle_pitch_link" />
    <exclude body1="right_ankle_pitch_link" body2="right_ankle_roll_link" />
    <exclude body1="right_ankle_roll_link" body2="right_toe_link" />
  </contact>


  <sensor>
    <!-- IMU sensors at pelvis -->
    <!-- Noise values from empirical robotics measurements with LSM6DSOX -->
    <!-- These include real-world effects: vibrations, quantization, mounting, etc. -->
    <!-- Gyro: 0.804% of ±2000 deg/s, Accel: 0.203% of ±16g -->
    <!-- Source: Empirical measurements from robotics research using LSM6DSOX -->
    <gyro name="imu_gyro" site="imu" noise="0.280649" cutoff="34.9" />
    <accelerometer name="imu_accel" site="imu" noise="0.318629" cutoff="157" />
    <framequat name="imu_quat" objtype="site" objname="imu" />
    <framelinvel name="imu_lin_vel" objtype="site" objname="imu" />
    <frameangvel name="imu_ang_vel" objtype="site" objname="imu" />

    <!-- Angular momentum sensor for whole robot -->
    <subtreeangmom name="root_angmom" body="pelvis_link" />

    <!-- Joint site sensors (for debugging) -->
    <framepos name="left_hip_pitch_joint_site_pos" objtype="site" objname="left_hip_pitch_joint_site" />
    <framequat name="left_hip_pitch_joint_site_quat" objtype="site" objname="left_hip_pitch_joint_site" />
    <framelinvel name="left_hip_pitch_joint_site_linvel" objtype="site" objname="left_hip_pitch_joint_site" />
    <frameangvel name="left_hip_pitch_joint_site_angvel" objtype="site" objname="left_hip_pitch_joint_site" />
    <velocimeter name="left_hip_pitch_joint_site_vel" site="left_hip_pitch_joint_site" />
  </sensor>
</mujoco>
